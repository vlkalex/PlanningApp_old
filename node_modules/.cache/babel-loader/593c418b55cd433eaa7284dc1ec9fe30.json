{"ast":null,"code":"import _regeneratorRuntime from\"/Users/alexvlk/Documents/Projects/GitHub/ConsultApp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/alexvlk/Documents/Projects/GitHub/ConsultApp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/alexvlk/Documents/Projects/GitHub/ConsultApp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import'../App.css';import React,{useState,useContext}from'react';import{styles}from'./css/dialog_css';import{GetTaskStatusData}from'../taskBubble/TaskStatusData';import moment from'moment';import Dialog from'@material-ui/core/Dialog';import Button from'@material-ui/core/Button';import Select from'@material-ui/core/Select';import MenuItem from'@material-ui/core/MenuItem';import FormControl from'@material-ui/core/FormControl';import TextField from'@material-ui/core/TextField';import{DatePicker,MuiPickersUtilsProvider}from\"@material-ui/pickers\";import MomentUtils from'@date-io/moment';import{FormatAlignLeftIcon,IconButton,DeleteIcon,CreateIcon,CloseIcon,FlagIcon,TimerIcon,TodayIcon,PhoneIcon,EmailIcon}from'../imports/icons';import{DataContext}from\"../providers/DataProvider\";import{UserContext}from\"../providers/UserProvider\";var renderTaskStatusBubble=function renderTaskStatusBubble(taskStatusData){var classes=styles();return/*#__PURE__*/React.createElement(\"span\",{className:classes.taskStatus,style:{backgroundColor:taskStatusData.color}},taskStatusData.title);};export function CommDetailDialog(props){var classes=styles();var onClose=props.onClose,selectedTask=props.selectedTask,open=props.open;var _useContext=useContext(DataContext),setRefresh=_useContext.setRefresh;var user=useContext(UserContext);var handleClose=function handleClose(){enterEditMode(false);onClose(selectedTask);};var taskStatusData=GetTaskStatusData(selectedTask.status);var _useState=useState(false),_useState2=_slicedToArray(_useState,2),editMode=_useState2[0],enterEditMode=_useState2[1];var _useState3=useState(taskStatusData.id),_useState4=_slicedToArray(_useState3,2),val=_useState4[0],setVal=_useState4[1];var handleStatusChange=function handleStatusChange(event){try{var requestOptions={method:'POST',headers:{'Content-Type':'application/json','Accept':'*/*','Authorization':'Bearer '+localStorage.getItem(\"@token\")},body:JSON.stringify({token:user.uid,collection:\"communication_tasks\",taskId:selectedTask.id,status:event.target.value})};fetch('https://europe-west1-plannerapp-960c1.cloudfunctions.net/app/api/update-task-status',requestOptions).then(function(response){return response.json();}).then(function(data){return setRefresh(data.taskId);});}catch(error){console.log(error);alert(\"Something went wrong. Please try again later.\");}setVal(event.target.value);selectedTask.status=event.target.value;};var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),titleState=_useState6[0],setTitle=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),descState=_useState8[0],setDesc=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),workTimeState=_useState10[0],setWorkTime=_useState10[1];var _useState11=useState(new Date()),_useState12=_slicedToArray(_useState11,2),selectedDate=_useState12[0],handleDateChange=_useState12[1];var editModeOn=function editModeOn(){enterEditMode(true);setTitle(selectedTask.title);setDesc(selectedTask.desc);setWorkTime(selectedTask.workTime);handleDateChange(moment(selectedTask.date,\"DD/MM/yyy\"));};var editModeOff=function editModeOff(){enterEditMode(false);setTitle('');setDesc('');setWorkTime('');};// moves the menu below the select input\nvar menuProps={anchorOrigin:{vertical:\"bottom\",horizontal:\"left\"},transformOrigin:{vertical:\"top\",horizontal:\"left\"},getContentAnchorEl:null};function updateTask(){return _updateTask.apply(this,arguments);}function _updateTask(){_updateTask=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var requestOptions;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:console.log(selectedTask.contact.email);_context.prev=1;requestOptions={method:'POST',headers:{'Content-Type':'application/json','Accept':'*/*','Authorization':'Bearer '+localStorage.getItem(\"@token\")},body:JSON.stringify({token:user.uid,taskId:selectedTask.id,title:selectedTask.title,desc:selectedTask.desc,date:moment(selectedDate).format(\"DD/MM/yyy\"),status:selectedTask.status,email:selectedTask.contact.email,phoneNumber:selectedTask.contact.phoneNumber,workTime:selectedTask.workTime})};_context.next=5;return fetch('https://europe-west1-plannerapp-960c1.cloudfunctions.net/app/api/update-comm-task',requestOptions).then(function(response){return response;});case 5:_context.next=11;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](1);console.log(_context.t0);alert(\"Something went wrong. Please try again later.\");case 11:setRefresh(selectedTask.id);editModeOff();case 13:case\"end\":return _context.stop();}}},_callee,null,[[1,7]]);}));return _updateTask.apply(this,arguments);};function deleteTask(){return _deleteTask.apply(this,arguments);}function _deleteTask(){_deleteTask=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var requestOptions;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;requestOptions={method:'POST',headers:{'Content-Type':'application/json','Accept':'*/*','Authorization':'Bearer '+localStorage.getItem(\"@token\")},body:JSON.stringify({taskId:selectedTask.id,token:user.uid})};_context2.next=4;return fetch('https://europe-west1-plannerapp-960c1.cloudfunctions.net/app/api/delete-comm-task',requestOptions).then(function(response){return response;});case 4:_context2.next=10;break;case 6:_context2.prev=6;_context2.t0=_context2[\"catch\"](0);console.log(_context2.t0);alert(\"Something went wrong. Please try again later.\");case 10:setRefresh(selectedTask.id);handleClose();case 12:case\"end\":return _context2.stop();}}},_callee2,null,[[0,6]]);}));return _deleteTask.apply(this,arguments);};return/*#__PURE__*/React.createElement(MuiPickersUtilsProvider,{utils:MomentUtils},/*#__PURE__*/React.createElement(Dialog,{onClose:handleClose,open:open,fullWidth:true,maxWidth:'xs',PaperProps:{style:{backgroundColor:'#FFEAC8',color:'black',borderRadius:'30px',padding:'35px',boxShadow:'0px 0px 15px 0px rgba(0,0,0,0.15)'},elevation:0},BackdropProps:{style:{backgroundColor:\"rgba(0, 0, 0, 0.25)\"}}},editMode?/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(TextField,{style:{width:\"70%\"},className:classes.taskTitleInput,value:selectedTask.title}),/*#__PURE__*/React.createElement(IconButton,{\"aria-label\":\"edit\",className:classes.editButton,onClick:function onClick(){deleteTask();}},/*#__PURE__*/React.createElement(DeleteIcon,{style:{color:'#c45a5a'}}))):/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"h1\",{className:classes.detailTitle},selectedTask.title),/*#__PURE__*/React.createElement(IconButton,{\"aria-label\":\"edit\",className:classes.editButton,onClick:function onClick(){editModeOn();}},/*#__PURE__*/React.createElement(CreateIcon,null))),/*#__PURE__*/React.createElement(IconButton,{\"aria-label\":\"close\",className:classes.closeButton,onClick:handleClose},/*#__PURE__*/React.createElement(CloseIcon,null)),/*#__PURE__*/React.createElement(\"span\",{style:{display:'flex',alignItems:'center',justifyContent:'start',padding:'10px 0px'}},/*#__PURE__*/React.createElement(FlagIcon,{style:{paddingTop:'2px'}}),/*#__PURE__*/React.createElement(FormControl,null,/*#__PURE__*/React.createElement(Select,{disableUnderline:true,classes:{root:classes.taskSelect},MenuProps:menuProps,value:taskStatusData.id,onChange:handleStatusChange},/*#__PURE__*/React.createElement(MenuItem,{value:\"done\"},renderTaskStatusBubble(GetTaskStatusData('done'))),/*#__PURE__*/React.createElement(MenuItem,{value:\"in_progress\"},renderTaskStatusBubble(GetTaskStatusData('in_progress'))),/*#__PURE__*/React.createElement(MenuItem,{value:\"not_done\"},renderTaskStatusBubble(GetTaskStatusData('not_done')))))),/*#__PURE__*/React.createElement(\"span\",{style:{display:'flex',alignItems:'flex-start',justifyContent:'start',padding:'10px 0px'}},/*#__PURE__*/React.createElement(FormatAlignLeftIcon,{style:{paddingTop:'2px'}}),editMode?/*#__PURE__*/React.createElement(TextField,{multiline:true,style:{width:\"70%\"},className:classes.taskDescInput,value:descState,onChange:function onChange(e){return setDesc(e.target.value);}}):/*#__PURE__*/React.createElement(\"h3\",{className:classes.detailText},selectedTask.desc)),/*#__PURE__*/React.createElement(\"div\",{style:{display:'flex',flexDirection:'row',justifyContent:'space-between',marginRight:'15%'}},/*#__PURE__*/React.createElement(\"span\",{style:{display:'flex',alignItems:'flex-start',justifyContent:'start',padding:'10px 0px'}},/*#__PURE__*/React.createElement(PhoneIcon,null),/*#__PURE__*/React.createElement(\"h3\",{className:classes.detailText},selectedTask.contact.phoneNumber)),/*#__PURE__*/React.createElement(\"span\",{style:{display:'flex',alignItems:'flex-start',justifyContent:'start',padding:'10px 0px'}},/*#__PURE__*/React.createElement(EmailIcon,null),/*#__PURE__*/React.createElement(\"h3\",{className:classes.detailText},selectedTask.contact.email))),/*#__PURE__*/React.createElement(\"span\",{style:{display:'flex',alignItems:'flex-start',justifyContent:'start',padding:'10px 0px'}},/*#__PURE__*/React.createElement(TimerIcon,null),/*#__PURE__*/React.createElement(\"h3\",{className:classes.detailText},selectedTask.workTime)),editMode?/*#__PURE__*/React.createElement(\"span\",{style:{display:'flex',alignItems:'center',justifyContent:'start',padding:'10px 0px'}},/*#__PURE__*/React.createElement(TodayIcon,null),/*#__PURE__*/React.createElement(DatePicker,{autoOk:true,disableToolbar:true,variant:\"inline\",inputVariant:\"outlined\",style:{width:90,marginLeft:10,background:'rgba(171, 171, 171, 0.15)',borderRadius:'5px',border:'none'},format:\"D.M.YYYY\",value:selectedDate,onChange:function onChange(date){return handleDateChange(date);}})):\"\",editMode?/*#__PURE__*/React.createElement(Button,{className:classes.updateTaskButton,onClick:function onClick(){editModeOff();updateTask();}},\"Aktualizova\\u0165\"):\"\"));}","map":{"version":3,"sources":["/Users/alexvlk/Documents/Projects/GitHub/ConsultApp/src/dialogWindows/CommDetailDialog.js"],"names":["React","useState","useContext","styles","GetTaskStatusData","moment","Dialog","Button","Select","MenuItem","FormControl","TextField","DatePicker","MuiPickersUtilsProvider","MomentUtils","FormatAlignLeftIcon","IconButton","DeleteIcon","CreateIcon","CloseIcon","FlagIcon","TimerIcon","TodayIcon","PhoneIcon","EmailIcon","DataContext","UserContext","renderTaskStatusBubble","taskStatusData","classes","taskStatus","backgroundColor","color","title","CommDetailDialog","props","onClose","selectedTask","open","setRefresh","user","handleClose","enterEditMode","status","editMode","id","val","setVal","handleStatusChange","event","requestOptions","method","headers","localStorage","getItem","body","JSON","stringify","token","uid","collection","taskId","target","value","fetch","then","response","json","data","error","console","log","alert","titleState","setTitle","descState","setDesc","workTimeState","setWorkTime","Date","selectedDate","handleDateChange","editModeOn","desc","workTime","date","editModeOff","menuProps","anchorOrigin","vertical","horizontal","transformOrigin","getContentAnchorEl","updateTask","contact","email","format","phoneNumber","deleteTask","style","borderRadius","padding","boxShadow","elevation","width","taskTitleInput","editButton","detailTitle","closeButton","display","alignItems","justifyContent","paddingTop","root","taskSelect","taskDescInput","e","detailText","flexDirection","marginRight","marginLeft","background","border","updateTaskButton"],"mappings":"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","sourcesContent":["import '../App.css';\nimport React, { useState, useContext } from 'react';\nimport { styles } from './css/dialog_css';\nimport { GetTaskStatusData } from '../taskBubble/TaskStatusData';\nimport moment from 'moment';\n\nimport PropTypes from 'prop-types';\nimport Dialog from '@material-ui/core/Dialog';\nimport Button from '@material-ui/core/Button';\nimport Select from '@material-ui/core/Select';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport FormControl from '@material-ui/core/FormControl';\nimport TextField from '@material-ui/core/TextField';\nimport { DatePicker, MuiPickersUtilsProvider } from \"@material-ui/pickers\";\nimport MomentUtils from '@date-io/moment';\n\nimport { \n    FormatAlignLeftIcon,\n    IconButton,\n    DeleteIcon,\n    CreateIcon,\n    CloseIcon,\n    FlagIcon,\n    TimerIcon,\n    TodayIcon,\n    PhoneIcon,\n    EmailIcon\n} from '../imports/icons';\n\nimport { DataContext } from \"../providers/DataProvider\";\nimport { UserContext } from \"../providers/UserProvider\";\n\nconst renderTaskStatusBubble = (taskStatusData) => {\n    const classes = styles();\n    return (\n        <span className={classes.taskStatus} style={{backgroundColor: taskStatusData.color}}>\n            {taskStatusData.title}\n        </span>\n    )\n}\n\nexport function CommDetailDialog(props) {\n    const classes = styles();\n\n    const { onClose, selectedTask, open } = props;\n    const { setRefresh } = useContext(DataContext);\n    const user = useContext(UserContext);\n\n    const handleClose = () => {\n        enterEditMode(false);\n        onClose(selectedTask);\n    };\n\n    const taskStatusData = GetTaskStatusData(selectedTask.status);\n\n    const [editMode, enterEditMode] = useState(false);\n\n    const [val,setVal] = useState(taskStatusData.id);\n\n    const handleStatusChange = (event) => {\n        try {\n            const requestOptions = {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json', 'Accept': '*/*',  'Authorization': 'Bearer ' + localStorage.getItem(\"@token\")},\n                body: JSON.stringify({ \n                    token: user.uid,\n                    collection: \"communication_tasks\",\n                    taskId: selectedTask.id,\n                    status: event.target.value,\n                    })\n            };\n            fetch('https://europe-west1-plannerapp-960c1.cloudfunctions.net/app/api/update-task-status', requestOptions)\n                .then(response => response.json())\n                .then(data => setRefresh(data.taskId));\n        } catch(error) {\n            console.log(error);\n            alert(\"Something went wrong. Please try again later.\")\n        }\n        setVal(event.target.value);\n        selectedTask.status = event.target.value;\n    };\n\n    const [titleState, setTitle] = useState('');\n    const [descState, setDesc] = useState('');\n    const [workTimeState, setWorkTime] = useState('');\n    const [selectedDate, handleDateChange] = useState(new Date());\n\n    const editModeOn = () => {\n        enterEditMode(true);\n        setTitle(selectedTask.title);\n        setDesc(selectedTask.desc);\n        setWorkTime(selectedTask.workTime);\n        handleDateChange(moment(selectedTask.date, \"DD/MM/yyy\"));\n    }\n\n    const editModeOff = () => {\n        enterEditMode(false);\n        setTitle('');\n        setDesc('');\n        setWorkTime('');\n    }\n\n    // moves the menu below the select input\n    const menuProps = {\n        anchorOrigin: {\n        vertical: \"bottom\",\n            horizontal: \"left\"\n        },\n        transformOrigin: {\n        vertical: \"top\",\n            horizontal: \"left\"\n        },\n        getContentAnchorEl: null\n    };\n\n    async function updateTask() {\n        console.log(selectedTask.contact.email)\n        try {\n            const requestOptions = {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json', 'Accept': '*/*', 'Authorization': 'Bearer ' + localStorage.getItem(\"@token\") },\n                body: JSON.stringify({ \n                    token: user.uid,\n                    taskId: selectedTask.id,\n                    title: selectedTask.title,\n                    desc: selectedTask.desc,\n                    date: moment(selectedDate).format(\"DD/MM/yyy\"),\n                    status: selectedTask.status,\n                    email: selectedTask.contact.email,\n                    phoneNumber: selectedTask.contact.phoneNumber,\n                    workTime: selectedTask.workTime,\n                })\n            };\n            await fetch('https://europe-west1-plannerapp-960c1.cloudfunctions.net/app/api/update-comm-task', requestOptions)\n            .then(response => response);\n        } catch(error) {\n            console.log(error);\n            alert(\"Something went wrong. Please try again later.\")\n        }\n\n        setRefresh(selectedTask.id);\n        editModeOff();\n    };\n\n    async function deleteTask() {\n        try {\n            const requestOptions = {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json', 'Accept': '*/*', 'Authorization': 'Bearer ' + localStorage.getItem(\"@token\") },\n                body: JSON.stringify({ taskId: selectedTask.id, token: user.uid })\n            };\n            await fetch('https://europe-west1-plannerapp-960c1.cloudfunctions.net/app/api/delete-comm-task', requestOptions)\n            .then(response => response);\n        } catch(error) {\n            console.log(error);\n            alert(\"Something went wrong. Please try again later.\")\n        }\n        setRefresh(selectedTask.id);\n        handleClose();\n    };\n\n    return (\n        <MuiPickersUtilsProvider utils={MomentUtils}>\n        <Dialog\n            onClose={handleClose}\n            open={open}\n            fullWidth={true}\n            maxWidth={'xs'}\n            PaperProps={{ style: { backgroundColor: '#FFEAC8', color: 'black', borderRadius: '30px', padding: '35px', boxShadow: '0px 0px 15px 0px rgba(0,0,0,0.15)', }, elevation: 0 }}\n            BackdropProps={{ style: { backgroundColor: \"rgba(0, 0, 0, 0.25)\" } }}\n        >\n            \n            { editMode\n                ?   <div>\n                        <TextField style={{width: \"70%\"}} className={classes.taskTitleInput} value={selectedTask.title}/>\n                        <IconButton aria-label=\"edit\" className={classes.editButton} onClick={() => {deleteTask()}}>\n                            <DeleteIcon style={{color: '#c45a5a'}}/>\n                        </IconButton> \n                    </div> \n                \n                :   <div>\n                        <h1 className={classes.detailTitle}>{selectedTask.title}</h1>\n                        <IconButton aria-label=\"edit\" className={classes.editButton} onClick={() => {editModeOn()}}>\n                            <CreateIcon />\n                        </IconButton>\n                    </div>\n            }\n\n            <IconButton aria-label=\"close\" className={classes.closeButton} onClick={handleClose}>\n                <CloseIcon />\n            </IconButton>\n\n            <span style={{ display: 'flex', alignItems: 'center', justifyContent: 'start', padding: '10px 0px' }}>\n                <FlagIcon style={{ paddingTop: '2px' }} />\n                <FormControl>\n                    <Select\n                        disableUnderline\n                        classes={{ root: classes.taskSelect }}\n                        MenuProps={menuProps}\n                        value={taskStatusData.id}\n                        onChange={handleStatusChange}\n                    >\n                        <MenuItem value={\"done\"}>{renderTaskStatusBubble(GetTaskStatusData('done'))}</MenuItem>\n                        <MenuItem value={\"in_progress\"}>{renderTaskStatusBubble(GetTaskStatusData('in_progress'))}</MenuItem>\n                        <MenuItem value={\"not_done\"}>{renderTaskStatusBubble(GetTaskStatusData('not_done'))}</MenuItem>\n                    </Select>\n                </FormControl>\n            </span>\n\n            <span style={{ display: 'flex', alignItems: 'flex-start', justifyContent: 'start', padding: '10px 0px' }}>\n                <FormatAlignLeftIcon style={{ paddingTop: '2px' }} />\n                { editMode \n                    ?   <TextField multiline style={{width: \"70%\"}} className={classes.taskDescInput} value={descState} onChange={e => setDesc(e.target.value)}/> \n                    :   <h3 className={classes.detailText}>\n                            {selectedTask.desc}\n                        </h3>\n                } \n            </span>\n\n            <div style={{ display: 'flex', flexDirection: 'row', justifyContent: 'space-between', marginRight: '15%'}}>\n                <span style={{ display: 'flex', alignItems: 'flex-start', justifyContent: 'start', padding: '10px 0px' }}>\n                    <PhoneIcon />\n                    <h3 className={classes.detailText}>\n                        {selectedTask.contact.phoneNumber}\n                    </h3>\n                </span>\n\n                <span style={{ display: 'flex', alignItems: 'flex-start', justifyContent: 'start', padding: '10px 0px' }}>\n                    <EmailIcon />\n                    <h3 className={classes.detailText}>\n                        {selectedTask.contact.email}\n                    </h3>\n                </span>\n            </div>\n\n            <span style={{ display: 'flex', alignItems: 'flex-start', justifyContent: 'start', padding: '10px 0px' }}>\n                <TimerIcon />\n                <h3 className={classes.detailText}>\n                    {selectedTask.workTime}\n                </h3>\n            </span>\n\n            { editMode \n                ?   <span style={{ display: 'flex', alignItems: 'center', justifyContent: 'start', padding: '10px 0px' }}>\n                        <TodayIcon />\n                        <DatePicker\n                            autoOk\n                            disableToolbar\n                            variant=\"inline\"\n                            inputVariant=\"outlined\"\n                            style={{ width: 90, marginLeft: 10, background: 'rgba(171, 171, 171, 0.15)', borderRadius: '5px', border: 'none' }}\n                            format=\"D.M.YYYY\"\n                            value={selectedDate}\n                            onChange={date => handleDateChange(date)}\n                        />\n                    </span>\n                :   \"\"\n            }\n\n            { editMode\n                ?   <Button className={classes.updateTaskButton} onClick={() => {editModeOff();updateTask()}}>\n                        Aktualizovať\n                    </Button>\n                :   \"\"\n            }\n\n        </Dialog>\n        </MuiPickersUtilsProvider>\n    );\n}\n\nCommDetailDialog.propTypes = {\n    onClose: PropTypes.func.isRequired,\n    open: PropTypes.bool.isRequired,\n    selectedTask: PropTypes.object.isRequired,\n};"]},"metadata":{},"sourceType":"module"}