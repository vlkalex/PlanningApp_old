{"ast":null,"code":"import _regeneratorRuntime from\"/Users/alexvlk/Documents/Projects/GitHub/ConsultApp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/alexvlk/Documents/Projects/GitHub/ConsultApp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/alexvlk/Documents/Projects/GitHub/ConsultApp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import'../App.css';import React,{useState,useContext}from'react';import{styles}from'./css/dialog_css';import{GetTaskStatusData}from'../taskBubble/TaskStatusData';import moment from'moment';import Dialog from'@material-ui/core/Dialog';import Button from'@material-ui/core/Button';import Select from'@material-ui/core/Select';import MenuItem from'@material-ui/core/MenuItem';import FormControl from'@material-ui/core/FormControl';import TextField from'@material-ui/core/TextField';import{DatePicker,MuiPickersUtilsProvider}from\"@material-ui/pickers\";import MomentUtils from'@date-io/moment';import{FormatAlignLeftIcon,IconButton,DeleteIcon,CreateIcon,CloseIcon,FlagIcon,TimerIcon,TodayIcon}from'../imports/icons';import{DataContext}from\"../providers/DataProvider\";import{UserContext}from\"../providers/UserProvider\";var renderTaskStatusBubble=function renderTaskStatusBubble(taskStatusData){var classes=styles();return/*#__PURE__*/React.createElement(\"span\",{className:classes.taskStatus,style:{backgroundColor:taskStatusData.color}},taskStatusData.title);};export function WorkDetailDialog(props){var classes=styles();var onClose=props.onClose,selectedTask=props.selectedTask,open=props.open;var _useContext=useContext(DataContext),setRefresh=_useContext.setRefresh;var user=useContext(UserContext);var handleClose=function handleClose(){enterEditMode(false);onClose(selectedTask);};var taskStatusData=GetTaskStatusData(selectedTask.status);var _useState=useState(false),_useState2=_slicedToArray(_useState,2),editMode=_useState2[0],enterEditMode=_useState2[1];var _useState3=useState(taskStatusData.id),_useState4=_slicedToArray(_useState3,2),val=_useState4[0],setVal=_useState4[1];var handleStatusChange=function handleStatusChange(event){try{var requestOptions={method:'POST',headers:{'Content-Type':'application/json','Accept':'*/*','Authorization':'Bearer '+localStorage.getItem(\"@token\")},body:JSON.stringify({collection:\"work_tasks\",token:user.uid,taskId:selectedTask.id,status:event.target.value})};fetch('https://europe-west1-plannerapp-960c1.cloudfunctions.net/app/api/update-task-status',requestOptions).then(function(response){return response.json();}).then(function(data){return setRefresh(data.taskId);});}catch(error){console.log(error);alert(\"Something went wrong. Please try again later.\");}setVal(event.target.value);selectedTask.status=event.target.value;};var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),titleState=_useState6[0],setTitle=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),descState=_useState8[0],setDesc=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),workTimeState=_useState10[0],setWorkTime=_useState10[1];var _useState11=useState(new Date()),_useState12=_slicedToArray(_useState11,2),selectedDate=_useState12[0],handleDateChange=_useState12[1];var editModeOn=function editModeOn(){enterEditMode(true);setTitle(selectedTask.title);setDesc(selectedTask.desc);setWorkTime(selectedTask.workTime);handleDateChange(moment(selectedTask.date,\"DD/MM/yyy\"));};var editModeOff=function editModeOff(){enterEditMode(false);setTitle('');setDesc('');setWorkTime('');};// moves the menu below the select input\nvar menuProps={anchorOrigin:{vertical:\"bottom\",horizontal:\"left\"},transformOrigin:{vertical:\"top\",horizontal:\"left\"},getContentAnchorEl:null};function updateTask(){return _updateTask.apply(this,arguments);}function _updateTask(){_updateTask=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var requestOptions;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;requestOptions={method:'POST',headers:{'Content-Type':'application/json','Accept':'*/*','Authorization':'Bearer '+localStorage.getItem(\"@token\")},body:JSON.stringify({token:user.uid,taskId:selectedTask.id,title:selectedTask.title,desc:selectedTask.desc,date:moment(selectedDate).format(\"DD/MM/yyy\"),status:selectedTask.status,workTime:selectedTask.workTime})};_context.next=4;return fetch('https://europe-west1-plannerapp-960c1.cloudfunctions.net/app/api/update-work-task',requestOptions).then(function(response){return response;});case 4:_context.next=10;break;case 6:_context.prev=6;_context.t0=_context[\"catch\"](0);console.log(_context.t0);alert(\"Something went wrong. Please try again later.\");case 10:setRefresh(selectedTask.id);editModeOff();case 12:case\"end\":return _context.stop();}}},_callee,null,[[0,6]]);}));return _updateTask.apply(this,arguments);};function deleteTask(){return _deleteTask.apply(this,arguments);}function _deleteTask(){_deleteTask=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var requestOptions;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;requestOptions={method:'POST',headers:{'Content-Type':'application/json','Accept':'*/*','Authorization':'Bearer '+localStorage.getItem(\"@token\")},body:JSON.stringify({taskId:selectedTask.id,token:user.uid})};_context2.next=4;return fetch('https://europe-west1-plannerapp-960c1.cloudfunctions.net/app/api/delete-work-task',requestOptions).then(function(response){return response;});case 4:_context2.next=10;break;case 6:_context2.prev=6;_context2.t0=_context2[\"catch\"](0);console.log(_context2.t0);alert(\"Something went wrong. Please try again later.\");case 10:setRefresh(selectedTask.id);handleClose();case 12:case\"end\":return _context2.stop();}}},_callee2,null,[[0,6]]);}));return _deleteTask.apply(this,arguments);};return/*#__PURE__*/React.createElement(MuiPickersUtilsProvider,{utils:MomentUtils},/*#__PURE__*/React.createElement(Dialog,{onClose:handleClose,open:open,fullWidth:true,maxWidth:'xs',PaperProps:{style:{backgroundColor:'#FFEAC8',color:'black',borderRadius:'30px',padding:'35px',boxShadow:'0px 0px 15px 0px rgba(0,0,0,0.15)'},elevation:0},BackdropProps:{style:{backgroundColor:\"rgba(0, 0, 0, 0.25)\"}}},editMode?/*#__PURE__*/React.createElement(TextField,{style:{width:\"70%\"},className:classes.taskTitleInput,value:selectedTask.title}):/*#__PURE__*/React.createElement(\"h1\",{className:classes.detailTitle},selectedTask.title),editMode?/*#__PURE__*/React.createElement(IconButton,{\"aria-label\":\"edit\",className:classes.editButton,onClick:function onClick(){deleteTask();}},/*#__PURE__*/React.createElement(DeleteIcon,{style:{color:'#c45a5a'}})):/*#__PURE__*/React.createElement(IconButton,{\"aria-label\":\"edit\",className:classes.editButton,onClick:function onClick(){editModeOn();}},/*#__PURE__*/React.createElement(CreateIcon,null)),/*#__PURE__*/React.createElement(IconButton,{\"aria-label\":\"close\",className:classes.closeButton,onClick:handleClose},/*#__PURE__*/React.createElement(CloseIcon,null)),/*#__PURE__*/React.createElement(\"span\",{style:{display:'flex',alignItems:'center',justifyContent:'start',padding:'10px 0px'}},/*#__PURE__*/React.createElement(FlagIcon,{style:{paddingTop:'2px'}}),/*#__PURE__*/React.createElement(FormControl,null,/*#__PURE__*/React.createElement(Select,{disableUnderline:true,classes:{root:classes.taskSelect},MenuProps:menuProps,value:taskStatusData.id,onChange:handleStatusChange},/*#__PURE__*/React.createElement(MenuItem,{value:\"done\"},renderTaskStatusBubble(GetTaskStatusData('done'))),/*#__PURE__*/React.createElement(MenuItem,{value:\"in_progress\"},renderTaskStatusBubble(GetTaskStatusData('in_progress'))),/*#__PURE__*/React.createElement(MenuItem,{value:\"not_done\"},renderTaskStatusBubble(GetTaskStatusData('not_done')))))),/*#__PURE__*/React.createElement(\"span\",{style:{display:'flex',alignItems:'flex-start',justifyContent:'start',padding:'10px 0px'}},/*#__PURE__*/React.createElement(FormatAlignLeftIcon,{style:{paddingTop:'2px'}}),editMode?/*#__PURE__*/React.createElement(TextField,{multiline:true,style:{width:\"70%\"},className:classes.taskDescInput,value:descState,onChange:function onChange(e){return setDesc(e.target.value);}}):/*#__PURE__*/React.createElement(\"h3\",{className:classes.detailText},selectedTask.desc)),/*#__PURE__*/React.createElement(\"span\",{style:{display:'flex',alignItems:'flex-start',justifyContent:'start',padding:'10px 0px'}},/*#__PURE__*/React.createElement(TimerIcon,null),/*#__PURE__*/React.createElement(\"h3\",{className:classes.detailText},selectedTask.workTime)),editMode?/*#__PURE__*/React.createElement(\"span\",{style:{display:'flex',alignItems:'center',justifyContent:'start',padding:'10px 0px'}},/*#__PURE__*/React.createElement(TodayIcon,null),/*#__PURE__*/React.createElement(DatePicker,{autoOk:true,disableToolbar:true,variant:\"inline\",inputVariant:\"outlined\",style:{width:90,marginLeft:10,background:'rgba(171, 171, 171, 0.15)',borderRadius:'5px',border:'none'},format:\"D.M.YYYY\",value:selectedDate,onChange:function onChange(date){return handleDateChange(date);}})):\"\",editMode?/*#__PURE__*/React.createElement(Button,{className:classes.updateTaskButton,onClick:function onClick(){editModeOff();updateTask();}},\"Aktualizova\\u0165\"):\"\"));}","map":{"version":3,"sources":["/Users/alexvlk/Documents/Projects/GitHub/ConsultApp/src/dialogWindows/WorkDetailDialog.js"],"names":["React","useState","useContext","styles","GetTaskStatusData","moment","Dialog","Button","Select","MenuItem","FormControl","TextField","DatePicker","MuiPickersUtilsProvider","MomentUtils","FormatAlignLeftIcon","IconButton","DeleteIcon","CreateIcon","CloseIcon","FlagIcon","TimerIcon","TodayIcon","DataContext","UserContext","renderTaskStatusBubble","taskStatusData","classes","taskStatus","backgroundColor","color","title","WorkDetailDialog","props","onClose","selectedTask","open","setRefresh","user","handleClose","enterEditMode","status","editMode","id","val","setVal","handleStatusChange","event","requestOptions","method","headers","localStorage","getItem","body","JSON","stringify","collection","token","uid","taskId","target","value","fetch","then","response","json","data","error","console","log","alert","titleState","setTitle","descState","setDesc","workTimeState","setWorkTime","Date","selectedDate","handleDateChange","editModeOn","desc","workTime","date","editModeOff","menuProps","anchorOrigin","vertical","horizontal","transformOrigin","getContentAnchorEl","updateTask","format","deleteTask","style","borderRadius","padding","boxShadow","elevation","width","taskTitleInput","detailTitle","editButton","closeButton","display","alignItems","justifyContent","paddingTop","root","taskSelect","taskDescInput","e","detailText","marginLeft","background","border","updateTaskButton"],"mappings":"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","sourcesContent":["import '../App.css';\nimport React, { useState, useContext } from 'react';\nimport { styles } from './css/dialog_css';\nimport { GetTaskStatusData } from '../taskBubble/TaskStatusData';\nimport moment from 'moment';\n\nimport PropTypes from 'prop-types';\nimport Dialog from '@material-ui/core/Dialog';\n\nimport Button from '@material-ui/core/Button'\nimport Select from '@material-ui/core/Select';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport FormControl from '@material-ui/core/FormControl';\nimport TextField from '@material-ui/core/TextField';\nimport { DatePicker, MuiPickersUtilsProvider } from \"@material-ui/pickers\";\nimport MomentUtils from '@date-io/moment';\n\nimport { \n    FormatAlignLeftIcon,\n    IconButton,\n    DeleteIcon,\n    CreateIcon,\n    CloseIcon,\n    FlagIcon,\n    TimerIcon,\n    TodayIcon\n} from '../imports/icons';\n\nimport { DataContext } from \"../providers/DataProvider\";\nimport { UserContext } from \"../providers/UserProvider\";\n\n\nconst renderTaskStatusBubble = (taskStatusData) => {\n    const classes = styles();\n    return (\n        <span className={classes.taskStatus} style={{backgroundColor: taskStatusData.color}}>\n            {taskStatusData.title}\n        </span>\n    )\n}\n\nexport function WorkDetailDialog(props) {\n    const classes = styles();\n\n    const { onClose, selectedTask, open } = props;\n    const { setRefresh } = useContext(DataContext);\n    const user = useContext(UserContext);\n\n    const handleClose = () => {\n        enterEditMode(false);\n        onClose(selectedTask);\n    };\n\n    const taskStatusData = GetTaskStatusData(selectedTask.status);\n\n    const [editMode, enterEditMode] = useState(false);\n\n    const [val,setVal] = useState(taskStatusData.id);\n\n    const handleStatusChange = (event) => {\n        try {\n            const requestOptions = {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json', 'Accept': '*/*', 'Authorization': 'Bearer ' + localStorage.getItem(\"@token\") },\n                body: JSON.stringify({ \n                    collection: \"work_tasks\",\n                    token: user.uid,\n                    taskId: selectedTask.id,\n                    status: event.target.value,\n                    })\n            };\n            fetch('https://europe-west1-plannerapp-960c1.cloudfunctions.net/app/api/update-task-status', requestOptions)\n                .then(response => response.json())\n                .then(data => setRefresh(data.taskId));\n        } catch(error) {\n            console.log(error);\n            alert(\"Something went wrong. Please try again later.\")\n        }\n        setVal(event.target.value);\n        selectedTask.status = event.target.value;\n    };\n\n    const [titleState, setTitle] = useState('');\n    const [descState, setDesc] = useState('');\n    const [workTimeState, setWorkTime] = useState('');\n    const [selectedDate, handleDateChange] = useState(new Date());\n\n    const editModeOn = () => {\n        enterEditMode(true);\n        setTitle(selectedTask.title);\n        setDesc(selectedTask.desc);\n        setWorkTime(selectedTask.workTime);\n        handleDateChange(moment(selectedTask.date, \"DD/MM/yyy\"));\n    }\n\n    const editModeOff = () => {\n        enterEditMode(false);\n        setTitle('');\n        setDesc('');\n        setWorkTime('');\n    }\n\n    // moves the menu below the select input\n    const menuProps = {\n        anchorOrigin: {\n        vertical: \"bottom\",\n            horizontal: \"left\"\n        },\n        transformOrigin: {\n        vertical: \"top\",\n            horizontal: \"left\"\n        },\n        getContentAnchorEl: null\n    };\n\n    async function updateTask() {\n        try {\n            const requestOptions = {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json', 'Accept': '*/*', 'Authorization': 'Bearer ' + localStorage.getItem(\"@token\") },\n                body: JSON.stringify({ \n                    token: user.uid,\n                    taskId: selectedTask.id,\n                    title: selectedTask.title,\n                    desc: selectedTask.desc,\n                    date: moment(selectedDate).format(\"DD/MM/yyy\"),\n                    status: selectedTask.status,\n                    workTime: selectedTask.workTime,\n                })\n            };\n            await fetch('https://europe-west1-plannerapp-960c1.cloudfunctions.net/app/api/update-work-task', requestOptions)\n            .then(response => response);\n        } catch(error) {\n            console.log(error);\n            alert(\"Something went wrong. Please try again later.\")\n        }\n\n        setRefresh(selectedTask.id);\n        editModeOff();\n    };\n\n    async function deleteTask() {\n        try {\n            const requestOptions = {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json', 'Accept': '*/*', 'Authorization': 'Bearer ' + localStorage.getItem(\"@token\") },\n                body: JSON.stringify({ taskId: selectedTask.id, token: user.uid })\n            };\n            await fetch('https://europe-west1-plannerapp-960c1.cloudfunctions.net/app/api/delete-work-task', requestOptions)\n            .then(response => response);\n        } catch(error) {\n            console.log(error);\n            alert(\"Something went wrong. Please try again later.\")\n        }\n\n        setRefresh(selectedTask.id);\n        handleClose();\n    };\n\n    return (\n        <MuiPickersUtilsProvider utils={MomentUtils}>\n        <Dialog\n            onClose={handleClose}\n            open={open}\n            fullWidth={true}\n            maxWidth={'xs'}\n            PaperProps={{ style: { backgroundColor: '#FFEAC8', color: 'black', borderRadius: '30px', padding: '35px', boxShadow: '0px 0px 15px 0px rgba(0,0,0,0.15)', }, elevation: 0 }}\n            BackdropProps={{ style: { backgroundColor: \"rgba(0, 0, 0, 0.25)\" } }}\n        >\n            { editMode\n                ? <TextField style={{width: \"70%\"}} className={classes.taskTitleInput} value={selectedTask.title}/> \n                : <h1 className={classes.detailTitle}>{selectedTask.title}</h1>\n            }\n            { editMode \n                ?   <IconButton aria-label=\"edit\" className={classes.editButton} onClick={() => {deleteTask()}}>\n                        <DeleteIcon style={{color: '#c45a5a'}}/>\n                    </IconButton>\n                :   <IconButton aria-label=\"edit\" className={classes.editButton} onClick={() => {editModeOn()}}>\n                        <CreateIcon />\n                    </IconButton>\n            }\n                \n            <IconButton aria-label=\"close\" className={classes.closeButton} onClick={handleClose}>\n                <CloseIcon />\n            </IconButton>\n\n            <span style={{ display: 'flex', alignItems: 'center', justifyContent: 'start', padding: '10px 0px' }}>\n                <FlagIcon style={{ paddingTop: '2px' }} />\n                <FormControl>\n                    <Select\n                        disableUnderline\n                        classes={{ root: classes.taskSelect }}\n                        MenuProps={menuProps}\n                        value={taskStatusData.id}\n                        onChange={handleStatusChange}\n                    >\n                        <MenuItem value={\"done\"}>{renderTaskStatusBubble(GetTaskStatusData('done'))}</MenuItem>\n                        <MenuItem value={\"in_progress\"}>{renderTaskStatusBubble(GetTaskStatusData('in_progress'))}</MenuItem>\n                        <MenuItem value={\"not_done\"}>{renderTaskStatusBubble(GetTaskStatusData('not_done'))}</MenuItem>\n                    </Select>\n                </FormControl>\n            </span>\n\n            <span style={{ display: 'flex', alignItems: 'flex-start', justifyContent: 'start', padding: '10px 0px' }}>\n                <FormatAlignLeftIcon style={{ paddingTop: '2px' }} />\n                { editMode \n                    ?   <TextField multiline style={{width: \"70%\"}} className={classes.taskDescInput} value={descState} onChange={e => setDesc(e.target.value)}/> \n                    :   <h3 className={classes.detailText}>\n                            {selectedTask.desc}\n                        </h3>\n                }\n                \n            </span>\n\n            <span style={{ display: 'flex', alignItems: 'flex-start', justifyContent: 'start', padding: '10px 0px' }}>\n                <TimerIcon />\n                <h3 className={classes.detailText}>\n                    {selectedTask.workTime}\n                </h3>\n            </span>\n\n            { editMode \n                ?   <span style={{ display: 'flex', alignItems: 'center', justifyContent: 'start', padding: '10px 0px' }}>\n                        <TodayIcon />\n                        <DatePicker\n                            autoOk\n                            disableToolbar\n                            variant=\"inline\"\n                            inputVariant=\"outlined\"\n                            style={{ width: 90, marginLeft: 10, background: 'rgba(171, 171, 171, 0.15)', borderRadius: '5px', border: 'none' }}\n                            format=\"D.M.YYYY\"\n                            value={selectedDate}\n                            onChange={date => handleDateChange(date)}\n                        />\n                    </span>\n                :   \"\"\n            }\n\n            { editMode\n                ?   <Button className={classes.updateTaskButton} onClick={() => {editModeOff();updateTask()}}>\n                        Aktualizovať\n                    </Button>\n                :   \"\"\n            }\n\n        </Dialog>\n        </MuiPickersUtilsProvider>\n    );\n}\n\nWorkDetailDialog.propTypes = {\n    onClose: PropTypes.func.isRequired,\n    open: PropTypes.bool.isRequired,\n    selectedTask: PropTypes.object.isRequired,\n};"]},"metadata":{},"sourceType":"module"}